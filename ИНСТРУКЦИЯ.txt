=====================================
  Telegram Mini App - Регистрация
  Инструкция по установке
=====================================

ЧТО ВАМ ПОНАДОБИТСЯ
--------------------
- Компьютер с Windows 10/11, macOS или Linux
- Аккаунт в Leadteh (leadteh.ru)
- Аккаунт на GitHub (github.com) — бесплатный, нужен для Vercel
- Telegram-бот (создаётся через @BotFather)
- Ссылки на ваши документы (оферта, политика и т.д.) — если нужны


УСТАНОВКА (Windows)
--------------------
1. Скачайте файл install.bat
2. Запустите его двойным кликом
3. Если потребуется — скрипт установит Git и Node.js автоматически
   (после установки может потребоваться перезапуск скрипта)
4. Скрипт скачает проект и запустит мастер настройки


УСТАНОВКА (macOS / Linux)
--------------------------
Вариант 1 — одной командой в терминале:
  curl -fsSL https://raw.githubusercontent.com/Roman72-186/telegram-webapp/main/install.sh | bash

Вариант 2 — скачать и запустить:
  1. Скачайте файл install.sh
  2. Откройте терминал в папке со скачанным файлом
  3. Выполните:
     chmod +x install.sh && ./install.sh

Скрипт автоматически проверит/установит Git и Node.js,
скачает проект и запустит мастер настройки.


ЧТО СПРОСИТ МАСТЕР НАСТРОЙКИ
-----------------------------
Мастер настройки (setup.js) задаст несколько вопросов:

1. Webhook URL из Leadteh
   Где найти: Leadteh → Настройки → Интеграции → Inner Webhook
   Формат: https://xxx.leadteh.ru/inner_webhook/xxx-xxx-xxx

2. Ссылки на документы (3 штуки):
   - URL оферты
   - URL политики конфиденциальности
   - URL согласия на обработку данных

   ВАЖНО: Если какой-то документ вам не нужен — просто нажмите Enter,
   чтобы пропустить. Соответствующий чекбокс не будет показан
   пользователю в форме.

   Например, если вам нужно только согласие на обработку данных —
   пропустите оферту и политику, укажите только третий URL.

3. API-токен Leadteh (для предзаполнения формы)
   Если у пользователя уже есть контакт в Leadteh, форма заполнится
   автоматически (имя, фамилия, телефон).
   Где найти токен: Leadteh → Настройки → API → Скопировать токен.
   Можно пропустить (Enter) — форма будет пустой.

   Если вы пропустили этот шаг, можно добавить токен позже вручную:
   Vercel Dashboard → Project → Settings → Environment Variables
   Имя: LEADTEH_API_TOKEN
   Значение: ваш токен из Leadteh

4. Токен Telegram-бота (для безопасности)
   Повышает безопасность — сервер будет проверять подпись запросов
   из Telegram (HMAC-SHA256 верификация initData).
   Где найти: Telegram → @BotFather → /mybots → выберите бота → API Token.
   Можно пропустить (Enter) — форма будет работать без верификации.

   Если вы пропустили этот шаг, можно добавить токен позже вручную:
   Vercel Dashboard → Project → Settings → Environment Variables
   Имя: TELEGRAM_BOT_TOKEN
   Значение: токен вашего бота из BotFather

5. Установка Vercel CLI
   Если Vercel CLI не установлен — скрипт предложит установить.
   Нужен для деплоя (размещения) приложения в интернете.

6. Деплой на Vercel
   Скрипт предложит сразу задеплоить проект.
   Если у вас нет аккаунта Vercel — откроется страница регистрации.
   Vercel бесплатный, можно войти через GitHub-аккаунт.
   Если у вас нет GitHub — сначала зарегистрируйтесь на github.com
   (бесплатно), затем через него войдите в Vercel.


ПОСЛЕ ДЕПЛОЯ
-------------
1. Скопируйте URL, который выдаст Vercel после деплоя
   (выглядит как https://ваш-проект.vercel.app)

2. Укажите этот URL в кнопке Web App одним из способов:

   Способ 1 — через @BotFather (самый простой):
     Telegram → @BotFather → /mybots → выберите бота →
     Bot Settings → Menu Button → вставьте URL

   Способ 2 — через конструктор бота (Leadteh, и др.):
     Если ваш конструктор поддерживает тип кнопки «Web App» —
     создайте кнопку с этим типом и вставьте URL.
     Это работает так же, как через BotFather.

   Способ 3 — из кода бота (для разработчиков):
     Отправьте кнопку с параметром web_app и вашим URL.
     Пример (python-telegram-bot):
       InlineKeyboardButton("Регистрация", web_app=WebAppInfo(url="ВАШ_URL"))

3. Готово! Теперь у бота появится кнопка с Web App.


КАК ЭТО РАБОТАЕТ
-----------------
1. Пользователь пишет /start вашему боту (создаётся контакт в Leadteh)
2. Нажимает кнопку Web App
3. Если API-токен настроен — форма автоматически заполнится данными
   из Leadteh (имя, фамилия, телефон). Пользователь может изменить их.
4. Заполняет/проверяет форму (имя, фамилия, телефон)
5. Отмечает необходимые чекбоксы согласий
6. Данные отправляются в Leadteh CRM


ОБНОВЛЕНИЕ
-----------
Если вышла новая версия, выполните в папке проекта:
  git pull origin main

Затем задеплойте заново:
  vercel --prod
